<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Simple Text Adventure</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.0/css/all.min.css">
    <script src="https://cdnjs.cloudflare.com/ajax/libs/three.js/r128/three.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/gsap/3.12.2/gsap.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/howler/2.2.3/howler.min.js"></script>
    <script src="https://unpkg.com/lenis@1.0.45/dist/lenis.min.js"></script>
    <style>
        :root {
            --primary: #6bffd3;
            --secondary: #ffd700;
            --accent: #ff6f61;
            --bg: #0a192f;
            --text: #f8f9fa;
        }
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }
        body {
            font-family: 'Space Mono', monospace;
            background: var(--bg);
            color: var(--text);
            overflow-x: hidden;
            perspective: 1000px;
        }
        .canvas-container {
            position: fixed;
            top: 0;
            left: 0;
            width: 100vw;
            height: 100vh;
            z-index: -1;
            filter: brightness(0.8) contrast(1.2);
        }
        .content {
            position: relative;
            min-height: 100vh;
            padding: 4rem 2rem;
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
        }
        .hero {
            text-align: center;
            margin-bottom: 4rem;
            position: relative;
        }
        .title {
            font-size: 5rem;
            background: linear-gradient(45deg, var(--primary), var(--secondary));
            -webkit-background-clip: text;
            background-clip: text;
            color: transparent;
            text-shadow: 0 0 30px rgba(107,255,211,0.3);
            margin-bottom: 2rem;
            transform-style: preserve-3d;
            user-select: none;
        }
        .story-container {
            max-width: 800px;
            margin: 0 auto;
            padding: 2rem;
            background: rgba(10, 25, 47, 0.9);
            border-radius: 20px;
            backdrop-filter: blur(10px);
            box-shadow: 0 0 50px rgba(107,255,211,0.1);
            border: 1px solid rgba(255,255,255,0.1);
            transform: translateZ(50px);
            user-select: none;
        }
        .choices-grid {
            display: grid;
            gap: 1.5rem;
            margin-top: 3rem;
        }
        .choice-card {
            padding: 2rem;
            background: linear-gradient(45deg, rgba(107,255,211,0.1), rgba(255,215,0,0.1));
            border-radius: 15px;
            cursor: pointer;
            transition: all 0.3s ease;
            position: relative;
            overflow: hidden;
            border: 1px solid rgba(255,255,255,0.1);
            user-select: none;
            opacity: 1;
        }
        .choice-card::before {
            content: '';
            position: absolute;
            top: 0;
            left: -100%;
            width: 100%;
            height: 100%;
            background: linear-gradient(90deg, transparent, rgba(255,255,255,0.1), transparent);
            transition: 0.5s;
        }
        .choice-card:hover::before {
            left: 100%;
        }
        .particle-overlay {
            position: fixed;
            top: 0;
            left: 0;
            pointer-events: none;
            z-index: 999;
        }
        .floating-island {
            position: fixed;
            bottom: -10vh;
            left: 50%;
            transform: translateX(-50%);
            width: 150vw;
            height: 150vh;
            background: linear-gradient(45deg, #1a1a1a, #2a2a2a);
            border-radius: 50%;
            filter: blur(50px);
            opacity: 0.1;
            z-index: -1;
        }
        @media (max-width: 768px) {
            .title { font-size: 3rem; }
            .story-container { padding: 1.5rem; }
        }
    </style>
</head>
<body>
    <div class="canvas-container" id="three-canvas"></div>
    <div class="particle-overlay" id="particles"></div>
    <div class="floating-island"></div>
    
    <div class="content">
        <div class="hero">
            <h1 class="title">Simple Text Adventure</h1>
            <div class="story-container">
                <div id="story" class="story-text"></div>
                <div class="choices-grid" id="choices"></div>
            </div>
        </div>
    </div>

    <script>
        const lenis = new Lenis()
        function raf(time) {
            lenis.raf(time)
            requestAnimationFrame(raf)
        }
        requestAnimationFrame(raf)

        const scene = new THREE.Scene()
        const camera = new THREE.PerspectiveCamera(75, window.innerWidth/window.innerHeight, 0.1, 1000)
        const renderer = new THREE.WebGLRenderer({ antialias: true, alpha: true })
        renderer.setSize(window.innerWidth, window.innerHeight)
        document.getElementById('three-canvas').appendChild(renderer.domElement)

        const particles = new THREE.BufferGeometry()
        const particleCount = 5000
        const posArray = new Float32Array(particleCount * 3)
        for(let i = 0; i < particleCount * 3; i++) {
            posArray[i] = (Math.random() - 0.5) * 10
        }
        particles.setAttribute('position', new THREE.BufferAttribute(posArray, 3))
        const material = new THREE.PointsMaterial({
            size: 0.005,
            color: new THREE.Color('#6bffd3'),
            transparent: true,
            blending: THREE.AdditiveBlending
        })
        const particleMesh = new THREE.Points(particles, material)
        scene.add(particleMesh)
        camera.position.z = 3

        const ambientLight = new THREE.AmbientLight(0xffffff, 0.5)
        scene.add(ambientLight)
        const pointLight = new THREE.PointLight(0x6bffd3, 1.5)
        pointLight.position.set(2, 2, 2)
        scene.add(pointLight)

        function animate() {
            requestAnimationFrame(animate)
            particleMesh.rotation.y += 0.001
            renderer.render(scene, camera)
        }
        animate()

        const storyData = {
            start: {
                text: "You find yourself standing in your grandmother's kitchen. The smell of cinnamon hangs in the air. Through the window, you see crows arguing in the old apple tree. On the counter:",
                choices: [
                    { text: "Take the rusted key hanging by the back door", next: "garden" },
                    { text: "Open the creaky recipe box", next: "recipe" },
                    { text: "Check the still-warm pie", next: "pie" }
                ]
            },
            garden: {
                text: "The key fits the tool shed. Inside, sunlight filters through dust motes. A shovel leans against a stack of yellowed newspapers from 1972. Behind them, you find:",
                choices: [
                    { text: "Take the bundle of love letters", next: "letters" },
                    { text: "Investigate the freshly dug patch of earth", next: "dig" },
                    { text: "Back to the kitchen", next: "start" }
                ]
            },
            recipe: {
                text: "The box contains recipes in spidery handwriting. Between the pages for blackberry cobbler and beef stew, you find a faded photo of two girls laughing. The back reads: 'Maggie & Clara, Summer '65'. You:",
                choices: [
                    { text: "Slip the photo into your pocket", next: "photo" },
                    { text: "Check the biscuit tin for more clues", next: "biscuit" }
                ]
            },
            pie: {
                text: "The pie crust crumbles perfectly. But inside... instead of apples, you find what looks like teeth. Your stomach drops. From the hallway, a floorboard creaks.",
                choices: [
                    { text: "Confront the noise", next: "confront" },
                    { text: "Run out the back door", next: "run" }
                ]
            },
            letters: {
                text: "The letters reveal a secret romance between Grandma and the town blacksmith. The last one ends abruptly: 'If they find out about the baby...'<br><br>You quietly return the letters. Some mysteries should stay buried."
            },
            dig: {
                text: "The fresh soil yields a small metal box containing a pearl necklace and a newspaper clipping: 'Local Infant Disappearance Still Unsolved'.<br><br>You rebury the box, understanding why Grandma always hated crows."
            },
            photo: {
                text: "As you pocket the photo, the house seems to sigh. The crows fall silent. In your pocket, the photo now shows three girls smiling.<br><br>You leave quickly, but the weight in your pocket lingers."
            },
            confront: {
                text: "The hallway stands empty. But the mirror shows someone behind you-<br><br>The pie cools untouched. They never did find your body."
            },
            run: {
                text: "You sprint past the apple tree. The crows take flight, their cries sounding like laughter.<br><br>Years later, you still wake tasting cinnamon and copper."
            }
        };

        function updateStory(storyId) {
            const story = storyData[storyId]
            if (!story) {
                updateStory('start')
                return
            }
            gsap.to('.story-container', { duration: 0.8, opacity: 0, y: 50, ease: 'power2.inOut', onComplete: () => {
                document.getElementById('story').innerHTML = `<p>${story.text}</p>`
                const choicesContainer = document.getElementById('choices')
                choicesContainer.innerHTML = ''
                if(story.choices) {
                    story.choices.forEach(choice => {
                        const choiceElement = document.createElement('div')
                        choiceElement.className = 'choice-card'
                        choiceElement.innerHTML = `<div class="choice-content"><span class="choice-glow"></span>${choice.text}</div>`
                        choiceElement.addEventListener('click', () => handleChoice(choice.next))
                        choicesContainer.appendChild(choiceElement)
                    })
                    gsap.from('.choice-card', { duration: 1, y: 30, stagger: 0.1, ease: 'elastic.out(1, 0.5)' })
                } else {
                    choicesContainer.innerHTML = `<div class="choice-card" onclick="updateStory('start')">Play Again</div>`
                }
            }})
            gsap.to('.story-container', { duration: 0.8, opacity: 1, y: 0, delay: 0.2, ease: 'power2.inOut' })
        }

        function handleChoice(nextId) {
            gsap.to('.choice-card', { duration: 0.3, scale: 0.9, ease: 'power2.out' })
            updateStory(nextId)
        }

        document.addEventListener('DOMContentLoaded', () => {
            gsap.from('.title', { duration: 2, opacity: 0, y: 100, ease: 'expo.out' })
            updateStory('start')
        })

        window.addEventListener('resize', () => {
            camera.aspect = window.innerWidth / window.innerHeight
            camera.updateProjectionMatrix()
            renderer.setSize(window.innerWidth, window.innerHeight)
        })
    </script>
</body>
</html>